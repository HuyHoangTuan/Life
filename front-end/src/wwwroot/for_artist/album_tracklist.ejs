<div>
    <div class="info">
        <h1>Album Details</h1>
        <!-- <h2>The Beatles</h2>
            <h3>The Beatles</h3>
            <p>The Beatles</p> -->
    </div>
    <ul class="list-nav">
        <li onclick="changePage('/for_artist/albums/<%= album.id %>')">Metadata</li>
        <li onclick="changePage('/for_artist/albums/<%= album.id %>/tracks')">Tracklist</li>
        <li onclick="changePage('/for_artist/albums/<%= album.id %>/comments')">Comments</li>
    </ul>
</div>
<div>
    <section>
        <h2>Track list</h2>
        <div class="flex-row">
            <button onclick="toggleDialog('dialog-add', addTrack)">
                Add Track
            </button>
            <button onclick="trackReset()">
                Reset
            </button>
            <button onclick="updateTracknum()">
                Save
            </button>
            <button onclick="document.getElementById('track-list').classList.toggle('edit-mode')">
                Toggle Edit
            </button>
        </div>
        <div class="grid-table" id="track-list">
            <div>
                <h3>#</h3>
                <h3>Title</h3>
                <h3>Duration</h3>
                <h3>=</h3>
            </div>
            <% album.tracks.forEach(track=> { %>
                <div onclick="showDetailDialog(this)" track-id="<%= track.id %>" track-num="<%= track.track_num %>"
                    track-title="<%= track.title%>" track-artist-id="<%= track.artist_id %>"
                    track-artist-name="<%= track.artist_name %>" track-audio="<%= track.id %>" draggable="true">
                    <span>
                        <%= track.track_num %>
                    </span>
                    <span>
                        <%- track.title %>
                    </span>
                    <span>
                        <%= new Date(null, null, null, null, null, track.duration).toTimeString().substr(3,5)%>
                    </span>
                    <span class="handle icon-font">drag_handle</span>
                    <span class="delete icon-font" onclick="deleteTrack(event, <%= track.id %>)">delete</span>
                    
                    <!-- <div class="drag-over-area-top"></div>
                    <div class="drag-over-area-bottom"></div> -->
                </div>
                <% }) %>
        </div>

    </section>
</div>
<script> initTrackDragNDrop(); </script>
<form class="dialog hidden" id="dialog-add" method="POST" action="/tracks" onsubmit="return false;">
    <span style="display: none;">
        <input value="<%= album.id %>" name="album_id">
        <input name="track_num">
    </span>
    <h1>Add track</h1>
    <div class="dialog-content">
        <div class="grid-dialog">
            <span>Title</span>
            <input type="text" name="track_name" origin-val="">
            <span>Audio</span>
                        <input type="file" accept="audio/mp3" name="file" target-field="preview-audio"  origin-val=""/>   .
            
        </div>
    </div>
    <div class="dialog-controls">
        <input type="reset" value="Reset">
        <button onclick="uploadTrack()">Add</button>
        <button onclick="toggleDialog('dialog-add', resetTForm)">Cancel</button>
    </div>
</form>

<form class="dialog hidden" id="dialog-detail" method="PUT" action="/tracks" onsubmit="return false;">
    <span style="display: none;">
        <input name="id" field="track-id">
    </span>
    <h1>Edit track</h1>
    <div class="dialog-content">
        <div class="grid-dialog">
            <span>Title</span>
            <input type="text" name="track_name" field="track-title">
        </div>
    </div>
    <div class="dialog-controls">
        <input type="reset" value="Reset">
        <button onclick="submitIDForm('dialog-detail')">Update</button>
        <button onclick="toggleDialog('dialog-detail', resetTForm)">Cancel</button>
    </div>
</form>

<script>initMiniPlayer()</script>
<script>document.querySelector('.linkk').setAttribute("onclick", "changePage('/for_artist/albums')")
</script>